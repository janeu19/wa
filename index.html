<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebSocket Chat</title>
</head>
<body>
  <input type="text" id="message" />
  <button type="button" id="send">Send</button>
  <ul id="messages"></ul>

  <script>
    // WebSocket URL
    const URL = "wss://yechnak.fun/websocket_chat_server.php";

    // WebSocket connection
    let websocket;

    // Message container
    const messagesDiv = document.getElementById("messages");

    // Connection status
    let connected = false;

    // Banned status
    let banned = false;

    // Connect to the WebSocket server
    function connect() {
      websocket = new WebSocket(URL);

      // On open
      websocket.onopen = function(event) {
        if (!banned) {
          alert("Connected");
        }
        connected = true;
        console.log("Connected to websocket server");
      };

      // On message
      websocket.onmessage = function(event) {
        // Check if the message is a server message
        if (event.data === "SERVER_MESSAGE: Banned.") {
          alert("Banned");
          banned = true;
          disconnect(); // Odpojte se, když jste zakázáni
        } else if (event.data === "SERVER_MESSAGE: Unbanned.") {
          alert("Unbanned");
          banned = false;
        } else {
          // Append the message to the message container
          messagesDiv.innerHTML = `<li>${event.data}</li>` + messagesDiv.innerHTML;
        }
      };

      // On close
      websocket.onclose = function(event) {
        if (!banned && connected) {
          alert("Disconnected");
        }
        connected = false;
        console.log("Disconnected from websocket server");

        // Retry connection after 1 second
        setTimeout(connect, 1000);
      };
    }

    // Send a message to the WebSocket server
    function sendMessage() {
      if (connected && !banned) { // Přidejte podmínku, která zkontroluje, zda nejste zakázáni
        const message = document.getElementById("message").value;
        websocket.send(message);
      }
    }

    // Disconnect from the WebSocket server
    function disconnect() {
      websocket.close();
      alert("You are banned. Disconnected.");
    }

    // Connect to the WebSocket server on page load
    connect();

    // Add event listener to the send button
    document.getElementById("send").addEventListener("click", sendMessage);
  </script>
</body>
</html>
